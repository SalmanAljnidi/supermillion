<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ† | Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø¬Ù†ÙŠØ¯ÙŠ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#020b2e">
    <style>
        /* --- Ø§Ù„ØªØµÙ…ÙŠÙ… (CSS) --- */
        :root {
            --bg-dark: #020b2e;
            --bg-light: #101e52;
            --gold: #d4af37;
            --gold-glow: #f9d877;
            --correct: #00c853;
            --wrong: #d50000;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(circle at center, var(--bg-light), var(--bg-dark));
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none;
        }

        /* Ø±Ø³Ù… Ø§Ù„Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„ÙƒÙˆØ¯ ÙÙ‚Ø· */
        .logo-box {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: radial-gradient(circle, #004d40, #000);
            border: 4px solid var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: var(--gold);
            font-weight: bold;
            box-shadow: 0 0 20px var(--gold);
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        .logo-box::after { content: "ØŸ"; }

        @keyframes pulse { 0% { box-shadow: 0 0 20px var(--gold); } 50% { box-shadow: 0 0 40px var(--gold); } 100% { box-shadow: 0 0 20px var(--gold); } }

        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen { display: none; width: 100%; height: 100%; flex-direction: column; align-items: center; justify-content: center; position: absolute; top: 0; left: 0; }
        .active { display: flex; }

        /* Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
        h1 { color: var(--gold); text-align: center; margin: 0; font-size: 2em; text-shadow: 2px 2px 4px #000; }
        .sub-text { font-size: 0.8em; color: #aaa; margin-bottom: 30px; margin-top: 10px; }
        
        .btn-main {
            background: linear-gradient(180deg, var(--gold), #8f7210);
            border: 2px solid #fff;
            padding: 15px 50px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            color: #000;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: transform 0.2s;
        }
        .btn-main:active { transform: scale(0.95); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-header { width: 90%; display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 1em; font-weight: bold; }
        .stat-box { background: rgba(0,0,0,0.6); padding: 8px 15px; border: 1px solid var(--gold); border-radius: 15px; color: var(--gold); }

        .question-box {
            width: 90%;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.8), transparent);
            border-top: 2px solid var(--gold);
            border-bottom: 2px solid var(--gold);
            padding: 20px 0;
            text-align: center;
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 30px;
            min-height: 60px;
            direction: ltr; /* Ù„Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª ØªØ¸Ù‡Ø± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .answers-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 95%; max-width: 600px; }
        
        .ans-btn {
            background: linear-gradient(to bottom, #1a237e, #000051);
            border: 2px solid #5c6bc0;
            color: white;
            padding: 15px;
            border-radius: 30px;
            font-size: 1.4rem;
            cursor: pointer;
            position: relative;
            transition: 0.3s;
            font-weight: bold;
        }
        .ans-btn:hover { background: #283593; border-color: var(--gold); }
        .ans-btn.selected { background: #ff9800; border-color: white; color: black; }
        .ans-btn.correct { background: var(--correct); border-color: #b9f6ca; animation: blink 0.4s 3; }
        .ans-btn.wrong { background: var(--wrong); border-color: #ff8a80; }

        @keyframes blink { 50% { opacity: 0.5; } }

        /* ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© */
        .lifelines { display: flex; gap: 20px; margin-bottom: 20px; }
        .life-btn {
            width: 50px; height: 50px; border-radius: 50%;
            background: transparent; border: 2px solid var(--gold);
            color: var(--gold); font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; transition: 0.3s;
        }
        .life-btn:hover { background: var(--gold); color: #000; }
        .life-btn:disabled { opacity: 0.3; cursor: not-allowed; border-color: #555; color: #555; text-decoration: line-through; }

        /* Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª */
        .install-btn {
            position: absolute; top: 10px; left: 10px;
            background: var(--gold); color: #000; border: none;
            padding: 8px 15px; border-radius: 15px; font-weight: bold;
            display: none; cursor: pointer; z-index: 100;
        }

        .footer { position: fixed; bottom: 5px; width: 100%; text-align: center; font-size: 12px; color: #666; }
    </style>
</head>
<body>

    <button id="installBtn" class="install-btn">ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ğŸ“²</button>

    <div id="startScreen" class="screen active">
        <div class="logo-box"></div>
        <h1>Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†<br><span style="font-size:0.6em; color:white">Ø¶Ø±Ø¨ ÙˆÙ‚Ø³Ù…Ø©</span></h1>
        <p class="sub-text">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…: Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø¬Ù†ÙŠØ¯ÙŠ</p>
        <button class="btn-main" onclick="initGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
    </div>

    <div id="gameScreen" class="screen">
        <div class="game-header">
            <div class="stat-box">Ø§Ù„Ø³Ø¤Ø§Ù„: <span id="qNum">Ù¡</span>/<span id="qTotal">Ù¡Ù¥</span></div>
            <div class="stat-box">Ø§Ù„Ø±ØµÙŠØ¯: <span id="qPrize">Ù </span> Ø±ÙŠØ§Ù„</div>
        </div>

        <div class="lifelines">
            <button class="life-btn" id="btn50" onclick="use5050()">50:50</button>
            <button class="life-btn" id="btnAud" onclick="useAudience()">ğŸ‘¥</button>
            <button class="life-btn" id="btnCall" onclick="useFriend()">ğŸ“</button>
        </div>

        <div class="question-box" id="questionText"></div>

        <div class="answers-grid">
            <button class="ans-btn" id="opt0" onclick="checkAnswer(0)"></button>
            <button class="ans-btn" id="opt1" onclick="checkAnswer(1)"></button>
            <button class="ans-btn" id="opt2" onclick="checkAnswer(2)"></button>
            <button class="ans-btn" id="opt3" onclick="checkAnswer(3)"></button>
        </div>
    </div>

    <div id="endScreen" class="screen">
        <div class="logo-box" style="width:80px; height:80px; font-size:40px;"></div>
        <h2 id="endMessage"></h2>
        <h1 id="finalPrize" style="color:var(--gold)"></h1>
        <br>
        <button class="btn-main" onclick="location.reload()">Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
    </div>

    <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ù…Ø¹Ù„Ù… Ø³Ù„Ù…Ø§Ù† Ø§Ù„Ø¬Ù†ÙŠØ¯ÙŠ Â© 2026</div>

    <script>
        /* --- Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© --- */
        function toArabicNum(num) {
            const arabicDigits = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
            return num.toString().replace(/\d/g, d => arabicDigits[d]);
        }

        /* --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ù„Ø¹Ø¨Ø© --- */
        const prizes = [100, 200, 300, 500, 1000, 2000, 4000, 8000, 16000, 32000, 64000, 125000, 250000, 500000, 1000000];
        let level = 0;
        let correctIndex = 0;
        let isLocked = false;
        
        // Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª (Web Audio API)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function beep(freq, duration, type='sine') {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            switch(type) {
                case 'start': beep(600, 0.1, 'square'); setTimeout(()=>beep(800, 0.3, 'square'), 100); break;
                case 'correct': beep(800, 0.1); setTimeout(()=>beep(1200, 0.4), 100); break;
                case 'wrong': beep(150, 0.5, 'sawtooth'); break;
                case 'wait': beep(400, 0.05); break;
            }
        }

        function initGame() {
            document.getElementById('startScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            playSound('start');
            loadQuestion();
        }

        function loadQuestion() {
            isLocked = false;
            document.getElementById('qNum').innerText = toArabicNum(level + 1);
            document.getElementById('qPrize').innerText = toArabicNum(prizes[level]);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            for(let i=0; i<4; i++) {
                let btn = document.getElementById('opt'+i);
                btn.className = 'ans-btn';
                btn.style.visibility = 'visible';
            }

            // --- Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ø¶Ø±Ø¨ ÙˆÙ‚Ø³Ù…Ø© 2-12) ---
            let type = Math.random() > 0.5 ? 'mul' : 'div';
            let n1, n2, ans, symbol;

            if (type === 'mul') {
                n1 = Math.floor(Math.random() * 11) + 2; // 2-12
                n2 = Math.floor(Math.random() * 11) + 2; // 2-12
                ans = n1 * n2;
                symbol = 'Ã—';
                // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                document.getElementById('questionText').innerText = `${toArabicNum(ans)} = ${toArabicNum(n1)} ${symbol} ØŸ`;
                // ØªØµØ­ÙŠØ­: Ø¬Ø¹Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© (Ø³ Ã— Øµ = ØŸ)
                document.getElementById('questionText').innerText = `${toArabicNum(n1)} ${symbol} ${toArabicNum(n2)} = ØŸ`;
            } else {
                let divisor = Math.floor(Math.random() * 11) + 2; // Ø§Ù„Ù…Ù‚Ø³ÙˆÙ… Ø¹Ù„ÙŠÙ‡
                let res = Math.floor(Math.random() * 11) + 2;     // Ø§Ù„Ù†Ø§ØªØ¬
                n1 = divisor * res; // Ø§Ù„Ù…Ù‚Ø³ÙˆÙ…
                n2 = divisor;
                ans = res;
                symbol = 'Ã·';
                document.getElementById('questionText').innerText = `${toArabicNum(n1)} ${symbol} ${toArabicNum(n2)} = ØŸ`;
            }

            // Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            let options = new Set([ans]);
            while(options.size < 4) {
                let diff = Math.floor(Math.random() * 5) + 1;
                let wrong = Math.random() > 0.5 ? ans + diff : ans - diff;
                if(wrong > 0 && wrong !== ans) options.add(wrong);
                else options.add(Math.floor(Math.random() * 100) + 1);
            }
            
            let arr = Array.from(options).sort(() => Math.random() - 0.5);
            for(let i=0; i<4; i++) {
                // Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                document.getElementById('opt'+i).innerText = toArabicNum(arr[i]);
                if(arr[i] === ans) correctIndex = i;
            }
        }

        function checkAnswer(idx) {
            if(isLocked) return;
            isLocked = true;
            let btn = document.getElementById('opt'+idx);
            btn.classList.add('selected');
            playSound('wait');

            setTimeout(() => {
                btn.classList.remove('selected');
                if(idx === correctIndex) {
                    btn.classList.add('correct');
                    playSound('correct');
                    setTimeout(() => {
                        if(level < 14) { level++; loadQuestion(); }
                        else gameOver(true);
                    }, 2000);
                } else {
                    btn.classList.add('wrong');
                    document.getElementById('opt'+correctIndex).classList.add('correct');
                    playSound('wrong');
                    setTimeout(() => gameOver(false), 2000);
                }
            }, 1500);
        }

        function gameOver(win) {
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('endScreen').classList.add('active');
            let msg = win ? "Ø£Ù†Øª Ø§Ù„Ù…Ù„ÙŠÙˆÙ†ÙŠØ±!" : "Ø­Ø¸Ø§Ù‹ Ø£ÙˆÙØ±";
            let money = 0;
            if(win) money = prizes[14];
            else {
                if(level >= 10) money = 32000;
                else if(level >= 5) money = 1000;
            }
            document.getElementById('endMessage').innerText = msg;
            document.getElementById('finalPrize').innerText = toArabicNum(money) + " Ø±ÙŠØ§Ù„";
        }

        // Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø§Øª
        function use5050() {
            let btn = document.getElementById('btn50');
            if(btn.disabled || isLocked) return;
            btn.disabled = true;
            let removed = 0;
            for(let i=0; i<4; i++) {
                if(i !== correctIndex && removed < 2 && Math.random()>0.5) {
                    document.getElementById('opt'+i).style.visibility = 'hidden';
                    removed++;
                }
            }
        }

        function useAudience() {
            let btn = document.getElementById('btnAud');
            if(btn.disabled || isLocked) return;
            btn.disabled = true;
            alert("Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙŠØ±Ø¬Ø­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ù†Ø³Ø¨Ø© Ù¨Ù Ùª!");
        }

        function useFriend() {
            let btn = document.getElementById('btnCall');
            if(btn.disabled || isLocked) return;
            btn.disabled = true;
            let val = document.getElementById('opt'+correctIndex).innerText;
            alert(`Ø§Ù„Ù…Ø¹Ù„Ù… Ø³Ù„Ù…Ø§Ù† ÙŠÙ‚ÙˆÙ„: Ø£Ø¹ØªÙ‚Ø¯ Ø§Ù„Ø¬ÙˆØ§Ø¨ Ù‡Ùˆ ${val}`);
        }

        // PWA Install
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'block';
        });
        installBtn.addEventListener('click', () => {
            installBtn.style.display = 'none';
            deferredPrompt.prompt();
        });

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
